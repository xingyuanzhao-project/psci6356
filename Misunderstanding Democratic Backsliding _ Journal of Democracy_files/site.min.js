!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("bows"),require("clipboardjs"),require("selectr"),require("twig"),require("autocomplete"),require("flickity")):"function"==typeof define&&define.amd?define(["bows","clipboardjs","selectr","twig","autocomplete","flickity"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).Site=e(t.bows,t.ClipboardJS,t.Selectr,t.Twig,t.autocomplete,t.Flickity)}(this,(function(t,e,i,s,o,n){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var a=r(t),l=r(e),c=r(i),d=r(s),h=r(o),p=r(n);var u=a.default("tooltip"),f=function(t){var e=this;this.opts=Object.assign({node:document.body,class:"tooltip",parentNode:document.body,duration:1500,fadeDuration:800},t),this.opts.text&&(this.opts.class=this.opts.class.trim(),this.tip=document.createElement("span"),this.tip.className=this.opts.class,this.tip.appendChild(document.createTextNode(this.opts.text)),this.arrow=document.createElement("span"),this.arrow.className=this.opts.class+"__arrow",this.tip.appendChild(this.arrow),this.show(),this._remove=function(){e.tip.removeEventListener("transitionend",e._remove),e.tip.parentNode.removeChild(e.tip)},u(this))};f.prototype.position=function(){var t=this.opts.node.getBoundingClientRect(),e=t.top+document.documentElement.scrollTop-this.tip.offsetHeight,i=t.left+t.width/2+document.documentElement.scrollLeft-this.tip.offsetWidth/2;this.tip.style.position="absolute",this.tip.style.top=e+"px",this.tip.style.left=i+"px";var s=this.tip.getBoundingClientRect();s.top<1&&(this.tip.classList.add(this.opts.class+"--below"),this.tip.style.top=e+this.opts.node.offsetHeight+s.height+"px",u("tooltip below")),i<0?(this.tip.classList.add(this.opts.class+"--offleft"),this.tip.style.left="5px",this.arrow.style.left=Math.abs(i)-5+"px",u("tooltip offleft",s)):i+s.width>document.documentElement.clientWidth&&(this.tip.classList.add(this.opts.class+"--right"),this.tip.style.left="auto",this.tip.style.right="5px",this.arrow.style.left="auto",this.arrow.style.right="5px",u("tooltip offright",s))},f.prototype.show=function(){this.tip.parentNode||this.opts.parentNode.appendChild(this.tip),this.position(),this.opts.duration>0&&setTimeout(this.remove.bind(this),this.opts.duration)},f.prototype.remove=function(){this.tip.classList.add("tooltip--removing"),this.tip.addEventListener("transitionend",this._remove)};var m=a.default("clipboard"),v=function(t){this.selector=t,l.default.isSupported()&&(this._clipboardjs=new l.default(this.selector),this._clipboardjs.on("success",(function(t){m("clipboard copied",t),new f({node:t.trigger,text:t.trigger.dataset["clipboard-tooltip"]||"Copied!",duration:parseInt(t.trigger.dataset["clipboard-tooltip-duration"],10)||1500})})),this._clipboardjs.on("error",(function(t){m("error",t)})),m(this))},g=a.default("selectr"),y=function(t,e){void 0===e&&(e={}),e=Object.assign({searchable:!1},e),t.getAttribute("data-selectr")&&(e=Object.assign(e,JSON.parse(t.getAttribute("data-selectr")))),e.placeholder||(e.placeholder=t.getAttribute("placeholder")||null);var i=new c.default(t,e);return g(t,e,i),i};function w(t){return t instanceof HTMLSelectElement?y(t):(t="string"==typeof t?document.querySelectorAll(t):t,Array.from(t).map(y))}var b=a.default("filters"),_=function(t){return t.replace(/\[(\d+)?\]/,"")},L=function(){this.loading=!1,this.loadingClass="filters--loading",this.form=document.querySelector(".filters__form"),this.pagination=document.querySelector(".filters__pagination"),this.items=document.querySelector(".filters__items"),this.share=document.querySelector(".filters__share"),this.selected=document.querySelector(".filters__selected"),this.title=document.querySelector(".filters__title"),this.twigs=Array.from(document.querySelectorAll('script[type="text/twig"]')),this.exceptions={outOfItems:"There are no more items"},this.excerptOpts={image:!0,excerpt:!0,issue:!0,supplement:!1},this.templates={},b(this)};L.prototype.init=function(){var t=this;if(b("filters init"),this.selectr(),this.items.getAttribute("data-excerpt-opts"))try{var e=JSON.parse(this.items.getAttribute("data-excerpt-opts"));e&&(this.excerptOpts=Object.assign(this.excerptOpts,e))}catch(t){}this.pagination&&this.pagination.addEventListener("click",(function(e){for(var i=e.target;"A"!==i.tagName;){if(i===t.pagination)return;i=i.parentNode}e.preventDefault(),t.load(i.href)})),this.twigs.length>0&&this.twigs.forEach((function(e){var i=e.dataset.template;t.templates[i]=d.default.twig({allowInlineIncludes:!0,id:i,data:e.innerHTML.trim()})})),this.form&&(this.form.addEventListener("submit",(function(e){e.preventDefault(),t.submit()})),this.form.addEventListener("change",(function(){return t.submit()})),this.form.addEventListener("click",(function(e){for(var i=e.target;i&&"A"!==i.tagName&&i!==t.selected;)i=i.parentNode;if(i&&i.classList.contains("filters__selected-facet")&&i.dataset.facet&&i.dataset.value){e.preventDefault();var s=_(i.dataset.facet),o=i.dataset.value,n=t.facets[s];b(n,s,t.facets),n.setValue(o)}}))),window.addEventListener("popstate",(function(e){t.load(e.target.location.href,!1)}))},L.prototype.submit=function(){if(!this.loading){var t=this._buildUrl();t!==location.href&&this.load(t)}},L.prototype._buildUrl=function(){var t=this.getFormData();return this.form.action+"?"+new URLSearchParams(t)},L.prototype.load=function(t,e){var i=this;void 0===e&&(e=!0),this.loading=!0,document.body.classList.add(this.loadingClass);var s=this.form.getBoundingClientRect(),o=window.scrollY||document.body.scrollTop||document.documentElement.scrollTop;if(s.top<o){var n=s.top+o,r=document.getElementById("header");r&&(n-=r.offsetHeight),b(s.top,o,r.offsetHeight,n),window.scrollTo(0,n)}var a=t+(t.indexOf("?")>-1?"&":"?")+"json=1";window.fetch(a,{headers:{Accept:"application/json"}}).then((function(t){if(b(t),!t.ok||"application/json"!==t.headers.get("Content-Type"))throw i.exceptions.outOfItems;return t.json()})).then((function(s){if(i.items){if(i.items.innerHTML="",!(s.posts&&s.posts.length>0))throw i.exceptions.outOfItems;s.posts.forEach((function(t){i.items.insertAdjacentHTML("beforeend",i.templates["partials/excerpt.twig"].render(Object.assign(i.excerptOpts,{post:t})))}))}if(i.title&&(i.title.innerHTML=i.templates["partials/archive-title.twig"].render(s)),i.pagination&&(s.pagination?i.pagination.innerHTML=i.templates["pagination.twig"].render(s.pagination):i.pagination.style.display="none"),i.share&&s.share&&(i.share.innerHTML=i.templates["partials/share.twig"].render(s.share)),s.filters){var o={search_query:s.filters.search_query,filters:s.filters,class:"filters--archive",opts:{}},n=i.form.dataset.opts;if(b("formOpts",n),n)try{o.opts=Object.assign(o.opts,JSON.parse(n))}catch(t){b(t)}s.orderby&&(o.opts.orderby=s.orderby),b("filters",o,o.opts);var r=document.createElement("div");r.innerHTML=i.templates["partials/filters.twig"].render(o),i.form.innerHTML=r.firstChild.innerHTML,i.selectr()}if(!0===e){var a=s.title?s.title:document.title;window.history.pushState({},a,t)}i.unload()})).catch((function(s){i.unload(s),i.pagination.innerHTML="",!0===e&&window.history.pushState({},null,t)}))},L.prototype.unload=function(t){void 0===t&&(t=""),this.loading=!1,document.body.classList.remove(this.loadingClass),t&&this.items&&(this.items.innerHTML=t)},L.prototype.getFormData=function(){return"object"==typeof this.formData?this.formData:new FormData(this.form)},L.prototype.selectr=function(){var t=this;b("selectr filters"),this.facets={},b(Array.from(this.form.querySelectorAll("select"))),Array.from(this.form.querySelectorAll("select")).forEach((function(e){t.facets[_(e.name)]=w(e)}))};var E={small_up:"(min-width: 600px)",medium_up:"(min-width: 768px)",large_up:"(min-width: 960px)",xlarge_up:"(min-width: 1100px)",xxlarge_up:"(min-width: 1400px)",small_down:"(max-width: 767px)",medium_down:"(max-width: 959px)",large_down:"(max-width: 1099px)",xlarge_down:"(max-width: 1399px)",xsmall_only:"(min-width: 0px) and (max-width: 599px)",small_only:"(min-width: 600px) and (max-width: 767px)",medium_only:"(min-width: 768px) and (max-width: 959px)",large_only:"(min-width: 960px) and (max-width: 1099px)",xlarge_only:"(min-width: 1100px) and (max-width: 1399px)",xxlarge_only:"(min-width: 1400px)",coarse_pointer:"( -moz-touch-enabled: 1), (pointer: coarse)",fine_pointer:"( -moz-touch-enabled: 0), (pointer: fine)",admin_bar_mobile:"(min-width: 0px) and (max-width: 600px)",admin_bar_tablet:"(min-width: 601px) and (max-width: 781px)",admin_bar_desktop:"(min-width: 782px)",max_width:"1400px"},x=a.default("throttle");function C(){return window.pageYOffset||document.documentElement.scrollTop||0}var S=a.default("HeaderReveal"),T=function(t,e){var i=this;if(void 0===e&&(e={}),this.node="string"==typeof t?document.querySelector(t):t,this.opts=Object.assign({revealedClass:"header--revealed",concealedClass:"header--concealed",revealedEvent:"header.revealed",concealedEvent:"header.concealed",threshold:20,throttle:50},e),this.adminBar=document.getElementById("wpadminbar"),this.node instanceof HTMLElement){this.visible=!0,this.revealed=!1,this.scrollY=C(),this.opts.threshold=Math.abs(this.opts.threshold);var s=function(t,e){void 0===e&&(e=50);var i=null;function s(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];i||(i=setTimeout((function(){t.apply(void 0,s),i=null}),e))}return x(t,e),s.cancel=function(){clearTimeout(i),i=null},s}((function(){var t=C();return i.adminBar&&t<=i.adminBar.offsetHeight||!i.adminBar&&0===t?(i.reset(),i.scrollY=t,void S("reset",t,i.scrollY)):(S(t,i.node.offsetHeight),i.visible&&t>i.scrollY+i.opts.threshold&&t>i.node.offsetHeight?(i.conceal(),i.scrollY=t,void S("conceal",t,i.scrollY)):!i.revealed&&t<=i.scrollY-i.opts.threshold?(i.reveal(),i.scrollY=t,void S("reveal",t,i.scrollY)):void(i.scrollY=t))}),this.opts.throttle);window.addEventListener("scroll",s),window.addEventListener("resize",s),document.addEventListener("click",(function(t){for(var e=t.target;e.parentNode&&"A"!==e.tagName;)e=e.parentNode;e&&"A"===e.tagName&&e.hash&&(i.conceal(),window.removeEventListener("scroll",s),setTimeout((function(){return window.addEventListener("scroll",s)}),1e3))}))}};T.prototype.conceal=function(){this.revealed=!1,this.visible=!1,this.node.classList.remove(this.opts.revealedClass),this.node.classList.add(this.opts.concealedClass),this.node.dispatchEvent(new CustomEvent(this.opts.concealedEvent)),S("concealed")},T.prototype.reveal=function(){this.revealed=!0,this.visible=!0,this.node.classList.add(this.opts.revealedClass),this.node.classList.remove(this.opts.concealedClass),this.node.dispatchEvent(new CustomEvent(this.opts.revealedEvent)),S("revealed")},T.prototype.reset=function(){this.revealed=!1,this.visible=!0,this.node.classList.remove(this.opts.revealedClass),this.node.classList.remove(this.opts.concealedClass),S("reset")};var A=a.default("MobileNav"),q=function(t,e){var i=this;void 0===e&&(e={}),this.node="string"==typeof t?document.querySelector(t):t,this.opts=Object.assign({openClass:"header--open",bodyClass:"fixed",opener:".header__menu-open",closer:".header__menu-close",openEvent:"header.open",closeEvent:"header.close"},e),this.node instanceof HTMLElement&&(this.opened=!1,this.opener="string"==typeof this.opts.opener?document.querySelector(this.opts.opener):this.opts.opener,this.closer="string"==typeof this.opts.closer?document.querySelector(this.opts.closer):this.opts.closer,this.opener instanceof HTMLElement&&this.opener.addEventListener("click",(function(t){t&&t.preventDefault&&t.preventDefault(),i.open()})),this.closer instanceof HTMLElement&&this.closer.addEventListener("click",(function(t){t&&t.preventDefault&&t.preventDefault(),i.close()})))};q.prototype.open=function(){A("open"),this.opened=!0,this.node.classList.add(this.opts.openClass),document.body.classList.add(this.opts.bodyClass),this.node.dispatchEvent(new Event(this.opts.openEvent))},q.prototype.close=function(){A("close"),this.opened=!1,this.node.classList.remove(this.opts.openClass),document.body.classList.remove(this.opts.bodyClass),this.node.dispatchEvent(new Event(this.opts.closeEvent))},q.prototype.toggle=function(){return A("toggle"),this.opened?this.close():this.open()};var M=a.default("overlay"),k=function(t){var e=this;if(void 0===t&&(t={}),this.opts=Object.assign({overlay:".overlay",classes:{open:"overlay--open",body:"fixed"},openers:[".header__search"],closers:[".overlay__close"],focused:'input[type="text"]'},t),this.node="string"==typeof this.opts.overlay?document.querySelector(this.opts.overlay):this.opts.overlay,this.node){if(this.opened=!1,this.opener=null,this.openers=Array.from(document.querySelectorAll(this.opts.openers.join(", "))),this.closer=null,this.closers=Array.from(document.querySelectorAll(this.opts.closers.join(", "))),this.openers.length>0){var i=function(t){t&&t.preventDefault&&t.preventDefault(),e.opener=t.target,e.open()};this.openers.forEach((function(t){t.addEventListener("click",i)}))}if(this.closers.length>0){var s=function(t){M("boundCloseClick"),t&&t.preventDefault&&t.preventDefault(),e.closer=t.target,e.close()};this.closers.forEach((function(t){M(t),t.addEventListener("click",s)}))}this.focused="string"==typeof this.opts.focused?this.node.querySelector(this.opts.focused):this.opts.focused,this.keyup=function(t){e.opened&&"Escape"===t.key&&e.close(e.initOpened)}}else M(".overlay missing, abort!")};k.prototype.open=function(){this.opened=!0,this.node.classList.add(this.opts.classes.open),document.addEventListener("keyup",this.keyup),this.focused&&(this.focused.focus(),this.focused.select()),M("open")},k.prototype.close=function(){document.removeEventListener("keyup",this.keyup),this.node.classList.remove(this.opts.classes.open),this.opener&&this.opener.focus(),this.opened=!1,M("closed")},k.prototype.toggle=function(){return!1===this.opened?this.open():this.close()};var j=a.default("panels"),H=function(t,e){var i=this;this.opts=Object.assign({openClass:"panels__panel--open",openingClass:"panels__panel--opening",closingClass:"panels__panel--closing",hoverDuration:125},e),this.node="string"==typeof t?document.querySelector(t):t,this.panels=Array.from(this.node.querySelectorAll(".panels__panel")),this.timeout=null,this.opened=-1,this.closing=null,this.opening=null;for(var s=0;s<this.panels.length;s++)if(this.panels[s].classList.contains(this.opts.openClass)){this.opened=s;break}-1===this.opened&&this.open(0),this.panels.forEach((function(t,e){t.addEventListener("mouseover",(function(){("function"!=typeof window.matchMedia||window.matchMedia(E.large_up).matches)&&("number"==typeof i.timeout&&window.clearTimeout(i.timeout),i.timeout=window.setTimeout((function(){i.open(e)}),i.opts.hoverDuration))})),t.addEventListener("mouseout",(function(){"number"==typeof i.timeout&&window.clearTimeout(i.timeout)})),t.addEventListener("click",(function(s){window.matchMedia(E.large_up).matches&&(e!==i.opened||t.classList.contains(i.opts.openingClass))&&(s.preventDefault(),i.open(e))})),t.addEventListener("focusin",(function(){i.open(e)}));var s=t.querySelector(".panels__toggler");s&&s.addEventListener("click",(function(){t.classList.contains("panels__panel--toggled")?(t.classList.remove("panels__panel--toggled"),s.innerHTML="+"):(t.classList.add("panels__panel--toggled"),s.innerHTML="-")}))})),this._onTransitionEnd=function(t){t.target.classList.remove(i.opts.closingClass),t.target.classList.remove(i.opts.openingClass),t.target.removeEventListener("transitionend",i._onTransitionEnd),j("_onTransitionEnd",i)},j(this)};H.prototype.open=function(t){this.opened>-1&&t!==this.opened&&(this.panels[this.opened].addEventListener("transitionend",this._onTransitionEnd),this.panels[this.opened].classList.remove(this.opts.openClass),this.panels[this.opened].classList.add(this.opts.closingClass)),this.opened=t,this.panels[this.opened].classList.contains(this.opts.openClass)||(this.panels[this.opened].addEventListener("transitionend",this._onTransitionEnd),this.panels[this.opened].classList.add(this.opts.openingClass),this.panels[this.opened].classList.add(this.opts.openClass))};var N=a.default("dropdown"),O=function(t,e){var i=this;void 0===e&&(e={}),this.node=t,this.opened=!1,this.opts=Object.assign({class:"nav__menu-item--open",delay:300},e),this.enterTimeout=null,this.leaveTimeout=null,this.node.addEventListener("mouseenter",(function(t){window.matchMedia(E.medium_up).matches&&(N("mouseenter",t,window.matchMedia(E.medium_down).matches),"number"==typeof i.leaveTimeout&&window.clearTimeout(i.leaveTimeout),i.enterTimeout=window.setTimeout((function(){i.open()}),i.opts.delay))})),this.node.addEventListener("mouseleave",(function(t){window.matchMedia(E.medium_up).matches&&(N("mouseleave",t,window.matchMedia(E.medium_down).matches),"number"==typeof i.enterTimeout&&window.clearTimeout(i.enterTimeout),i.leaveTimeout=window.setTimeout((function(){i.close()}),i.opts.delay))})),this.node.addEventListener("touchstart",(function(t){if(window.matchMedia(E.medium_up).matches){if(!1===i.opened&&t.target.parentNode===i.node)return N("touch toggle"),t.preventDefault(),t.stopPropagation(),i.open();"A"===t.target.tagName&&(N("touch menu link"),t.stopPropagation())}})),this.listen=function(t){for(var e=t.target,s=[e];e.parentNode;)s.push(e),e=e.parentNode;-1===s.indexOf(i.node)&&i.close()}};O.prototype.open=function(){N("open"),this.opened=!0,this.node.classList.add(this.opts.class),this.node.dispatchEvent(new Event("dropdown.open")),document.addEventListener("click",this.listen)},O.prototype.close=function(){N("close"),this.opened=!1,this.node.classList.remove(this.opts.class),this.node.dispatchEvent(new Event("dropdown.close")),document.removeEventListener("click",this.listen)},O.prototype.toggle=function(){return N("toggle"),this.opened?this.close():this.open()};var D=a.default("primary-nav"),B=function(t,e){var i=this;void 0===e&&(e={}),this.opts=Object.assign({openClass:"nav__menu-item--open",parents:".nav__menu-item--has-children",delay:100,children:".nav__menu",togglers:".nav__menu-toggle"},e),this.node="string"==typeof t?document.querySelector(t):t,this.node?(this.parents=Array.from(this.node.querySelectorAll(this.opts.parents)),this.parents.forEach((function(t){t.addEventListener("dropdown.open",(function(){i.dropdowns.forEach((function(e){D("dropdown.open",e.node,t,e.node!==t),e.opened&&e.node!==t&&e.close()}))}))})),this.dropdowns=this.parents.map((function(t){return new O(t,{class:i.opts.openClass,delay:i.opts.delay})})),this.mobileTogglers=this.parents.map((function(t){return t.querySelector(i.opts.togglers)})),this.mobileTogglers.forEach((function(t,e){t&&t.addEventListener("click",(function(){var s=i.parents[e];s.classList.contains(i.opts.openClass)?(t.innerHTML="+",s.classList.remove(i.opts.openClass)):(t.innerHTML="―",s.classList.add(i.opts.openClass))}))})),D(this)):D("node missing, abort!")},I=a.default("search-ac"),z=function(t,e){var i=this;void 0===e&&(e={}),this.node=t,this.node.setAttribute("autocomplete","off"),this.opts=Object.assign({loadingClass:"search-form--ac-loading",matchClass:"search-form__ac-match"},e),this.field=this.node.querySelector(".search-form__field"),this.cache={},this.loading=document.createElement("i"),this.loading.className="search-form__ac-spinner",this.loading.insertAdjacentHTML("beforeend",'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32"><path d="M32 16c-0.040-2.089-0.493-4.172-1.331-6.077-0.834-1.906-2.046-3.633-3.533-5.060-1.486-1.428-3.248-2.557-5.156-3.302-1.906-0.748-3.956-1.105-5.981-1.061-2.025 0.040-4.042 0.48-5.885 1.292-1.845 0.809-3.517 1.983-4.898 3.424s-2.474 3.147-3.193 4.994c-0.722 1.846-1.067 3.829-1.023 5.79 0.040 1.961 0.468 3.911 1.254 5.694 0.784 1.784 1.921 3.401 3.316 4.736 1.394 1.336 3.046 2.391 4.832 3.085 1.785 0.697 3.701 1.028 5.598 0.985 1.897-0.040 3.78-0.455 5.502-1.216 1.723-0.759 3.285-1.859 4.574-3.208 1.29-1.348 2.308-2.945 2.977-4.67 0.407-1.046 0.684-2.137 0.829-3.244 0.039 0.002 0.078 0.004 0.118 0.004 1.105 0 2-0.895 2-2 0-0.056-0.003-0.112-0.007-0.167h0.007zM28.822 21.311c-0.733 1.663-1.796 3.169-3.099 4.412s-2.844 2.225-4.508 2.868c-1.663 0.646-3.447 0.952-5.215 0.909-1.769-0.041-3.519-0.429-5.119-1.14-1.602-0.708-3.053-1.734-4.25-2.991s-2.141-2.743-2.76-4.346c-0.621-1.603-0.913-3.319-0.871-5.024 0.041-1.705 0.417-3.388 1.102-4.928 0.683-1.541 1.672-2.937 2.883-4.088s2.642-2.058 4.184-2.652c1.542-0.596 3.192-0.875 4.832-0.833 1.641 0.041 3.257 0.404 4.736 1.064 1.48 0.658 2.82 1.609 3.926 2.774s1.975 2.54 2.543 4.021c0.57 1.481 0.837 3.064 0.794 4.641h0.007c-0.005 0.055-0.007 0.11-0.007 0.167 0 1.032 0.781 1.88 1.784 1.988-0.195 1.088-0.517 2.151-0.962 3.156z"></path></svg>'),this.ac=h.default({debounceWaitMs:200,input:this.field,className:"search-form__ac",onSelect:function(t){window.location.href=t.value},fetch:function(t,e){return i.cache[t]?e(i.cache[t]):(i.node.classList.add(i.opts.loadingClass),i.field.parentNode.appendChild(i.loading),window.fetch("/?s="+encodeURIComponent(t)+"&json=1",{headers:{Accept:"application/json"}}).then((function(t){return I(t),t.json()})).then((function(s){var o=s.posts.map((function(t){return t.label=t.title,t.value=t.link,t}));return i.cache[t]=o,e(o)})).catch((function(t){I("err",t)})).finally((function(){i.node.classList.remove(i.opts.loadingClass),i.loading.parentNode&&i.loading.parentNode.removeChild(i.loading)})),!0)},render:function(t){var e=document.createElement("div");return e.className=i.opts.matchClass,e.appendChild(document.createTextNode(t.label.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(e)})))),e}}),I(this.ac)},Y=function(t){t.propertyName&&"height"===t.propertyName&&(this.removeEventListener("transitionend",Y),this.style.height="")};var R=a.default("citation"),F=function(t,e){var i=this;if(this.node=t,this.opts=Object.assign({content:".citation__content",openClass:"citation--open",loadingClass:"citation--loading",errorMsg:"Sorry, there was an error fetching that citation format. Please try a different one.",buttonText:"Copy",localStorageKey:"citationFormat",hidden:!0},e),this.format=null,this.opened=!1,this.content=this.node.querySelector(this.opts.content),this.opts.hidden,!1!==this.opts.buttonText){var s=document.createElement("p");this.copy=document.createElement("button"),this.copy.type="button",this.copy.setAttribute("data-clipboard-target",this.opts.content),this.copy.insertAdjacentHTML("afterbegin",'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M18.984 21v-14.016h-10.969v14.016h10.969zM18.984 5.016c1.078 0 2.016 0.891 2.016 1.969v14.016c0 1.078-0.938 2.016-2.016 2.016h-10.969c-1.078 0-2.016-0.938-2.016-2.016v-14.016c0-1.078 0.938-1.969 2.016-1.969h10.969zM15.984 0.984v2.016h-12v14.016h-1.969v-14.016c0-1.078 0.891-2.016 1.969-2.016h12z"></path></svg>'),this.copy.insertAdjacentHTML("beforeend",this.opts.buttonText),this.copy.className="citation__copy button",s.appendChild(this.copy),this.content.parentNode.appendChild(s),this.clipboard=new v(".citation__copy")}this.loadingIcon=document.createElement("i"),this.loadingIcon.insertAdjacentHTML("afterbegin",'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M32 16c-0.040-2.089-0.493-4.172-1.331-6.077-0.834-1.906-2.046-3.633-3.533-5.060-1.486-1.428-3.248-2.557-5.156-3.302-1.906-0.748-3.956-1.105-5.981-1.061-2.025 0.040-4.042 0.48-5.885 1.292-1.845 0.809-3.517 1.983-4.898 3.424s-2.474 3.147-3.193 4.994c-0.722 1.846-1.067 3.829-1.023 5.79 0.040 1.961 0.468 3.911 1.254 5.694 0.784 1.784 1.921 3.401 3.316 4.736 1.394 1.336 3.046 2.391 4.832 3.085 1.785 0.697 3.701 1.028 5.598 0.985 1.897-0.040 3.78-0.455 5.502-1.216 1.723-0.759 3.285-1.859 4.574-3.208 1.29-1.348 2.308-2.945 2.977-4.67 0.407-1.046 0.684-2.137 0.829-3.244 0.039 0.002 0.078 0.004 0.118 0.004 1.105 0 2-0.895 2-2 0-0.056-0.003-0.112-0.007-0.167h0.007zM28.822 21.311c-0.733 1.663-1.796 3.169-3.099 4.412s-2.844 2.225-4.508 2.868c-1.663 0.646-3.447 0.952-5.215 0.909-1.769-0.041-3.519-0.429-5.119-1.14-1.602-0.708-3.053-1.734-4.25-2.991s-2.141-2.743-2.76-4.346c-0.621-1.603-0.913-3.319-0.871-5.024 0.041-1.705 0.417-3.388 1.102-4.928 0.683-1.541 1.672-2.937 2.883-4.088s2.642-2.058 4.184-2.652c1.542-0.596 3.192-0.875 4.832-0.833 1.641 0.041 3.257 0.404 4.736 1.064 1.48 0.658 2.82 1.609 3.926 2.774s1.975 2.54 2.543 4.021c0.57 1.481 0.837 3.064 0.794 4.641h0.007c-0.005 0.055-0.007 0.11-0.007 0.167 0 1.032 0.781 1.88 1.784 1.988-0.195 1.088-0.517 2.151-0.962 3.156z"></path></svg>'),this.loadingIcon.className="citation__loading",this.select=this.node.querySelector("select"),this.post_id=this.select.getAttribute("data-post-id");var o=localStorage.getItem(this.opts.localStorageKey);o&&(this.select.value=o),this.select.addEventListener("change",(function(){R("change",i.select.value),i.request(i.select.value)}))};F.prototype.close=function(){var t=this;this.opened=!1,this.node.dispatchEvent(new CustomEvent("citation.close")),function(t,e){void 0===e&&(e=null);var i=t.getBoundingClientRect();t.style.height=i.height+"px",t.addEventListener("transitionend",Y),"function"==typeof e&&setTimeout((function(){t.style.height="0px",e()}),10)}(this.node,(function(){return t.node.classList.remove(t.opts.openClass)})),R("close")},F.prototype.open=function(){var t=this;this.opened=!0,this.node.dispatchEvent(new CustomEvent("citation.open")),function(t,e){void 0===e&&(e=null),t.style.height="auto";var i=t.getBoundingClientRect();t.style.height=i.height+"px",t.addEventListener("transitionend",Y),"function"==typeof e&&(t.style.height="0",setTimeout((function(){t.style.height=i.height+"px",e()}),10))}(this.node,(function(){return t.node.classList.add(t.opts.openClass)})),this.format||this.request(this.select.value),R("open")},F.prototype.toggle=function(){return this.opened?this.close():this.open()},F.prototype.request=function(t){var e=this;this.prepare(),this.format=t,localStorage.setItem(this.opts.localStorageKey,t),this.data?this.data[t]?this.complete(this.data[t]):this.complete(this.opts.errorMsg):fetch("/wp-json/jod/v1/citations/"+this.post_id).then((function(t){if(!t.ok)throw new Error("Invalid response");return t.json()})).then((function(i){if(e.data=i,R(i,t,i[t]),!e.data[t])throw new Error("Format not included");e.complete(e.data[t]),R(e.opts.loadingClass)})).catch((function(t){R("err",t),e.complete(e.opts.errorMsg)}))},F.prototype.prepare=function(){this.node.appendChild(this.loadingIcon),this.node.classList.add(this.opts.loadingClass),this.select.setAttribute("disabled","disabled")},F.prototype.complete=function(t){void 0===t&&(t=""),this.select.removeAttribute("disabled"),this.node.classList.remove(this.opts.loadingClass),this.loadingIcon.parentNode.removeChild(this.loadingIcon),this.select.focus(),this.content.innerHTML=t};var J=a.default("article"),P=function(t){var e;this.opts=t,this.citations=Array.from(document.querySelectorAll(".citation")).map((function(t){return new F(t)})),this.citations.length&&(e=this.citations.filter((function(t){return t.node.classList.contains("article__citation")}))).length&&(e=e.shift());var i=document.querySelector(".article__action--view-citation a");i&&e&&(i.addEventListener("click",(function(t){t.preventDefault(),e.toggle()})),e.node.addEventListener("citation.open",(function(){J("citation.open"),i.classList.add("article__action--active"),i.innerHTML=i.innerHTML.replace(/\bView\b/,"Hide")})),e.node.addEventListener("citation.close",(function(){J("citation.close"),i.classList.remove("article__action--active"),i.innerHTML=i.innerHTML.replace(/\bHide\b/,"View")}))),J(this)};var U=a.default("author-grid"),G=function(t,e){var i=this;this.node=t,this.opts=Object.assign({activeClass:"author-grid__group--active",anchors:".author-grid__anchor",authors:".author-grid__author",debounce:500,filteredAuthorClass:"author-grid__author--match",filteredClass:"author-grid--filtered",form:".author-grid__search",groups:".author-grid__group",search:".author-grid__search-input"},e),this.active=!1,this.filtered=!1,this.search=this.node.querySelector(this.opts.search),this.form=this.node.querySelector(this.opts.form),this.anchors=Array.from(this.node.querySelectorAll(this.opts.anchors)),this.groups={},this.authors=Array.from(this.node.querySelectorAll(this.opts.authors)).map((function(t){return{text:t.textContent.replace(/\s+/g,"").replace(/[^a-zA-Z]/g,"").toLowerCase(),node:t}})),Array.from(this.node.querySelectorAll(this.opts.groups)).forEach((function(t){t.id&&(i.groups[t.id]=t)})),this.defaultGroup=Object.keys(this.groups).shift();var s=function(t){U("sameAnchorCheck",t.target.hash),t.target.hash===window.location.hash&&i.groups[window.location.hash]&&i.unfilter().activate(t.target.hash)};return this.anchors.forEach((function(t){return t.addEventListener("click",s)})),this.form.addEventListener("submit",(function(t){return t.preventDefault()})),this.search.addEventListener("keypress",function(t,e){void 0===e&&(e=100);var i=null,s=function(){clearTimeout(i),i=null};function o(){for(var o=[],n=arguments.length;n--;)o[n]=arguments[n];s(),i=setTimeout((function(){t.apply(void 0,o)}),e)}return o.cancel=s,o}(this.route.bind(this),this.opts.debounce)),window.addEventListener("hashchange",(function(){return U("hashchange"),i.unfilter().route()})),this.route()};G.prototype.activate=function(t){var e=this;return U("activate",t),this.active&&this.groups[this.active]&&this.groups[this.active].classList.remove(this.opts.activeClass),this.active=t,!1!==this.active?this.groups[this.active].classList.add(this.opts.activeClass):this.filtered&&Object.keys(this.groups).forEach((function(t){return e.groups[t].classList.add(e.opts.activeClass)})),this},G.prototype.filter=function(t){var e=this;return t=t.toLowerCase().replace(/\s+/g,""),this.filtered=!0,this.node.classList.add(this.opts.filteredClass),this.activate(!1),this.authors.forEach((function(i){i.text.indexOf(t)>-1?i.node.classList.add(e.opts.filteredAuthorClass):i.node.classList.remove(e.opts.filteredAuthorClass)})),this},G.prototype.unfilter=function(){var t=this;return U("unfilter"),this.filtered=!1,this.node.classList.remove(this.opts.filteredClass),this.authors.forEach((function(e){return e.node.classList.remove(t.opts.filteredAuthorClass)})),Object.keys(this.groups).forEach((function(e){return t.groups[e].classList.remove(t.opts.activeClass)})),this.search.value&&(this.search.value=""),this},G.prototype.route=function(){return this.search.value?(U("route",this.search.value),this.filter(this.search.value)):(this.filtered&&this.unfilter(),window.location.hash&&this.groups[window.location.hash]?(U("route",window.location.hash),this.activate(window.location.hash)):(U("route","default"),this.activate(this.defaultGroup)))};var K=a.default("subscribe"),V=function(t){this.opts=t;var e=document.querySelector(".author-grid");e&&(this.authorGrid=new G(e)),K(this)};var W=function(t){var e=this;this.node=t,this.wrap=t.querySelector(".mr__items"),this.items=Array.from(t.querySelectorAll(".mr__item")),this.flickity=new p.default(this.wrap,{cellAlign:"left",arrowShape:"M28,57.67,56.66,87.18a7.68,7.68,0,0,1,0,10.62,7.13,7.13,0,0,1-10.3,0L0,50,46.36,2.22a7.13,7.13,0,0,1,10.3,0,7.68,7.68,0,0,1,0,10.62l0,0L27.75,42.65l65-.15a7.51,7.51,0,0,1,0,15Z",on:{ready:function(){e.nav=document.createElement("div"),e.nav.className="mr__nav",e.wrap.appendChild(e.nav),e.pageDots=e.wrap.querySelector(".flickity-page-dots"),e.prevButton=e.wrap.querySelector(".flickity-button.previous"),e.nextButton=e.wrap.querySelector(".flickity-button.next"),[e.prevButton,e.pageDots,e.nextButton].forEach((function(t){t&&e.nav.appendChild(t)})),e.resize()}}}),window.addEventListener("resize",this.resize.bind(this))};W.prototype.resize=function(){this.items.forEach((function(t){return t.style.height=""}));var t=this.items.map((function(t){return t.offsetHeight})),e=Math.max.apply(null,t);this.items.forEach((function(t){return t.style.height=e+"px"}))};var Z=a.default("subscribe"),Q=function(t){this.opts=t,this.mostRead=Array.from(document.querySelectorAll(".mr")).map((function(t){return new W(t)})),Z(this)};var X=a.default("issue"),$=function(t){this.opts=t,this.nav=w(document.querySelector(".issue__navigation select")),this.nav.on("selectr.change",(function(t){t.value&&(window.location.href=t.value)})),X(this)};a.default("bows");var tt=a.default("excerpts"),et=function(t){function e(){t.call(this),this.pagination=document.querySelector(".excerpts__pagination"),this.items=document.querySelector(".excerpts__items"),tt(this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(L),it=a.default("subscribe"),st=function(t){this.opts=t,this.excerpts=new et,this.excerpts.init(),it(this)};var ot=a.default("subscribe"),nt=function(t){this.opts=t,this.quotes=Array.from(document.querySelectorAll(".subscribe__quotes")).map((function(t){var e=t.querySelector(".subscribe__quotes-wrap");return e?new p.default(e,{cellAlign:"left",adaptiveHeight:!1,arrowShape:"M28,57.67,56.66,87.18a7.68,7.68,0,0,1,0,10.62,7.13,7.13,0,0,1-10.3,0L0,50,46.36,2.22a7.13,7.13,0,0,1,10.3,0,7.68,7.68,0,0,1,0,10.62l0,0L27.75,42.65l65-.15a7.51,7.51,0,0,1,0,15Z",on:{ready:function(){var e=document.createElement("div");e.className="flickity__nav",t.appendChild(e);var i=t.querySelector(".flickity-page-dots");[t.querySelector(".flickity-button.previous"),i,t.querySelector(".flickity-button.next")].forEach((function(t){t&&e.appendChild(t)}))}}}):null})),ot(this)};var rt=a.default("site"),at=function(){var t=this;this.mediaQueries=E,document.addEventListener("DOMContentLoaded",(function(){return t.ready()})),window.addEventListener("load",(function(){return t.load()}))};return at.prototype.ready=function(){var t;this.clipboard=new v("[data-clipboard-text]"),this.fitvids=function(t){var e={selectors:['iframe[src*="player.vimeo.com"]','iframe[src*="youtube.com"]','iframe[src*="youtube-nocookie.com"]',"object","embed"]};t&&(Array.isArray(t)||(t=[t]),e.selectors=e.selectors.concat(e.selectors).filter((function(t,e,i){return i.indexOf(t)===e})));var i=Array.prototype.slice.call(document.querySelectorAll(e.selectors.join(",")));return i.length>0&&i.forEach((function(t){if(!t.getAttribute("data-fitvid")){var e=document.createElement("div"),i=window.getComputedStyle(t),s=100*(i.height>0&&i.width>0?i.height/i.width:9/16);e.className="fitvid",e.style.width="100%",e.style.height=0,e.style.position="relative",e.style.paddingTop=s+"%",t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.width="100%",t.style.height="100%",t.setAttribute("data-fitvid",s),t.parentNode.insertBefore(e,t),e.appendChild(t)}})),i}(),this.mobileHeader=new T(".header"),this.mobileNav=new q(".header"),this.primaryNav=new B(".nav--primary"),this.overlay=new k,this.panels=Array.from(document.querySelectorAll(".panels")).map((function(t){return new H(t)})),this.searchAC=Array.from(document.querySelectorAll(".search-form")).map((function(t){return new z(t)})),this.filters=Array.from(document.querySelectorAll(".filters")).map((function(t){var e=new L(t);return e.init(),e})),document.body.classList.contains("page-template-authors")&&(this.authors=(void 0===t&&(t={}),new V(t))),document.body.classList.contains("subscribe")&&(this.subscribe=function(t){return void 0===t&&(t={}),new nt(t)}()),document.body.classList.contains("page-template-home")&&(this.home=function(t){return void 0===t&&(t={}),new Q(t)}()),document.body.classList.contains("news-features")&&(this.newsFeatures=function(t){return void 0===t&&(t={}),new st(t)}()),document.body.classList.contains("single-article")&&(this.article=function(t){return void 0===t&&(t={}),new P(t)}()),document.body.classList.contains("issue")&&(this.issue=function(t){return void 0===t&&(t={}),new $(t)}()),rt("document.DOMContentLoaded")},at.prototype.load=function(){!function(){var t=a.default("links:emptyLinks"),e=Array.prototype.slice.call(document.querySelectorAll('a[href=""], a[href="#"]'));e.forEach((function(e){e.addEventListener("click",(function(i){i.preventDefault(),t("empty link not followed",e)}))})),t("There are "+e.length+" empty links on this page",e)}(),rt("window.load")},at}));
//# sourceMappingURL=site.min.js.map
