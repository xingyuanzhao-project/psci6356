(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{818:function(e,t){var i,n;i=$("body"),n={$select:null,init:function init(){n.control()},control:function control(){i.on("change","#institutionList",(function(e){e.preventDefault(),n.$select=$(this);var t=n.$select.val();location.href=t})),$("#institutionList").val(location.toString())}},UX.profileMain=n},819:function(e,t){var i,n,o;n=$("body"),o={$target:null,$toggle:null,$ul:null,$li:null,isMobile:parseInt((null===(i=UX.grid)||void 0===i?void 0:i.screenSm)&&UX.grid.screenSm-.2)>=window.innerWidth,vPort:"screen-sm",classes:{iconChevronDown:"icon-arrow_d_n pull-right"},init:function init(){o.$target=$(".profile-menu"),o.on.build(),o.control()},control:function control(){n.on("click",".profile-menu--res a",(function(e){o.on.select.dropdown($(this))})),$(document).on(o.vPort+"-on",(function(){o.isMobile||(o.isMobile=!0,o.on.build())})),$(document).on(o.vPort+"-off",(function(){o.isMobile&&(o.isMobile=!1,o.on.build())}))},on:{select:{dropdown:function dropdown(e){("dropdown"===e.closest("ul").data("mobile-toggle")||e.closest("ul").hasClass("dropblock--tab"))&&e.closest(".dropBlock").children("a").find("span").text(e.text())}},dropdownBuild:function dropdownBuild(e){UX.dropBlock&&UX.dropBlock.init(),e.wrap('<div class="profile-menu--dropBlock" data-db-parent-of="dbTab-profile-menu"></div>');var t=e.closest(".profile-menu--dropBlock"),i=o.get.activeTab(e);t.prepend('<a href="#" data-db-target-for="dbTab-profile-menu"><span>'+i.text()+'</span><i class="'+o.classes.iconChevronDown+'" aria-hidden="true"></i></a>'),e.attr("data-db-target-of","dbTab-profile-menu")},dropdownDestroy:function dropdownDestroy(e){e.closest(".profile-menu--dropBlock").children("a").remove(),e.removeAttr("data-db-target-of").removeClass("js--open").removeAttr("style").unwrap(".profile-menu--dropBlock")},build:function build(){o.isMobile?($(".profile-menu").addClass("profile-menu--res"),o.on.dropdownBuild(o.$target)):($(".profile-menu").removeClass("profile-menu--res"),o.on.dropdownDestroy(o.$target))}},get:{activeTab:function activeTab(e){return e.find("a.active,.active a")}}},UX.dropblockUl=o},820:function(e,t){var i;i={init:function init(){i.control()},control:function control(){$(document).on("change",".trustedProxyUserId",(function(){this.closest("form").submit()}))}},UX.trustedPoxy=i},821:function(e,t){var i;i={$form:$("#institutionUsageReport"),report_input_name:"counterIds",submitActor:null,$submitActors:null,$usageReports:$(".usageReports"),init:function init(){this.$submitActors=this.$form.find("button[type=submit]"),i.controller(),i.additionalController()},controller:function controller(){i.$submitActors.click((function(e){i.submitActor=this})),i.$form.submit((function(e){e.preventDefault(),null===i.submitActor&&(i.submitActor=i.$submitActors[0]),$("<input />").attr("type","hidden").attr("name",i.submitActor.name).attr("value","").appendTo(i.$form);var t=$(this).children(".error_msg"),n=i.check.dateRange(),o=i.check.selectedReports();if(n&&o)$(this).unbind("submit").submit(),t.hide();else{var r=$('[name="notify"]').next(".error_msg");r.hide(),t.hide(),"notify"===i.submitActor.name?(r.html(i.$usageReports.data("errors-below")),r.show()):(t.html(i.$usageReports.data("errors")),t.show())}})),i.$form.on("click change",".ranges-selects select",(function(){i.on.selectRange()})),i.$form.on("click change",".year-select select",(function(){i.on.selectYear()}))},additionalController:function additionalController(){},error_msg:function error_msg(e){alert("Errors:\n"+e)},on:{selectRange:function selectRange(){var e=i.$form.find("#dateRange");e.find('input[type="radio"]').prop("checked",!1),e.find("input#range-date").prop("checked",!0)},selectYear:function selectYear(){var e=i.$form.find("#dateRange");e.find('input[type="radio"]').prop("checked",!1),e.find("input#year-date").prop("checked",!0)}},check:{dateRange:function dateRange(){var e=i.$form.find("#dateRange");if(e.find("input#range-date:checked").length){var t=e.find("select#startMonthId").val(),n=e.find("select#startYear").val(),o=new Date(n,t,1);t=e.find("select#endMonthId").val(),n=e.find("select#endYear").val();var r=new Date(n,t,1),a=[];o>r&&a.push(i.$usageReports.data("invalid-month-range")),i.monthDiff(o,r)>10&&a.push(i.$usageReports.data("invalid-month-number"));var s=e.find(".error_msg");return a.length?(s.html(a.join("<br>")),s.show(),!1):(s.html(""),s.hide(),!0)}return!0},selectedReports:function selectedReports(){var e=i.$form.find("#reports"),t=e.find(".error_msg");return e.find('input[name="'+i.report_input_name+'"]:checked').length?(t.html(""),t.hide(),!0):(t.html(i.$usageReports.data("select-report-error")),t.show(),!1)}},monthDiff:function monthDiff(e,t){var i;return i=12*(t.getFullYear()-e.getFullYear()),i-=e.getMonth()+1,(i+=t.getMonth())<=0?0:i}},UX.reports=i},822:function(e,t){!function(){var e=$("body");function createAndAppendInput(e,t,i){var n=document.createElement("input");n.type="hidden",n.name=e,n.value=t,i.append(n)}var t={$target:null,$toggle:null,$successMsg:null,alertTabs:{newContent:"#pane-content",citation:"#pane-citation",custom:"#pane-custom",title:"#pane-title",artByArt:"#pane-axa",collection:"#pane-collection",digest:"#pane-digest",topical:"#pane-topical",doAlert:"#pane-do"},init:function init(){t.$toggle=$("[name='markall']"),t.$successMsg=$(".alerts .success-message"),t.control(),t.additionalController()},control:function control(){e.on("click",'[name="markall"]',(function(e){t.$target=$(this).closest(".alert__list"),$(this).closest("#citationAlerts").length&&(t.$target=$("#citationAlerts")),$(this).prop("checked")?t.$target.find('[type="checkbox"]:not(:checked)').click():t.$target.find('[type="checkbox"]:checked').click()})),e.on("change",".alert__freq",(function(e){t.on.frequency_change($(this))})),e.on("change",".alert__sort",(function(e){t.on.sorting_change($(this))})),e.on("click",".js__citActions",(function(e){t.on.cit_actions_change($(this))})),e.on("click",".btn--cancel",(function(e){e.preventDefault(),t.on.reset_form($(this))})),t.$successMsg.length&&e.on("click",".alerts .tab__nav__item__link",(function(e){t.on.showHideSuccessMsg(e.target)}))},additionalController:function additionalController(){},on:{build:function build(){},error_msg:function error_msg(){alert("Please select one publication at least")},frequency_change:function frequency_change(e){var t=e.parents("form");t.find("input[name=action]").val(""),createAndAppendInput("save","true",t),createAndAppendInput("updateAxa","true",t),t.submit()},sorting_change:function sorting_change(e){var t=e.find("select").val(),i="#"+e.closest(".tab__pane.active").attr("id");sessionStorage.setItem("activeTab",i),$('<form action="/action/showAlertSettings"><input type="hidden" name="type" value="citation" /><input type="hidden" name="menuTab" value="Alerts"/><input type="hidden" name="sortBy" value="'+t+'"/></form>').appendTo("body").submit()},cit_actions_change:function cit_actions_change(e){var i=e.parents("form"),n=e.attr("data-value");if(n)if($('input[type=checkbox][name="citId"]:checked').length){i.find("input[name=action]").val(n),e.parents(".dropBlock__holder").length&&UX.dropBlock.on.hide();var o="#"+e.closest(".tab__pane.active").attr("id");sessionStorage.setItem("activeTab",o),i.get(0).submit()}else t.on.error_msg()},reset_form:function reset_form(e){var t=e.closest("form");t.trigger("reset"),t.find("input[name=pubCode], input[name=markall], input[name=doCode]").prop("checked",!1),t.find("input[name=format][value=T]").prop("checked",!0)},showHideSuccessMsg:function showHideSuccessMsg(e){var i=t.$successMsg.data("related-alert");$(e).attr("href")===t.alertTabs[i]?t.$successMsg.show():t.$successMsg.hide()}}};UX.alerts=t}()},823:function(e,t,i){var n,o;n=$("body"),o={$pairedDevicesTable:$(".device-pairing__devices table"),$noPairedDevicesResult:$(".device-pairing__devices .no-result"),$pairingHistoryTable:$(".device-pairing__history table"),pairingHistoryTableRow:".device-pairing__history tbody tr",$noPairedDevicesHistoryResult:$(".device-pairing__history .no-result"),$instAdminUnpairSelectedBtn:$("#instAdminUnpairSelected"),$instAdminUnpairAllBtn:$("#instAdminUnpairAll"),$unpairDialogForm:$("#unpairDevicesDialogForm"),selectedDevicesArray:[],$deviceSelectedList:$(".device-pairing__selectedList"),$unpairButtonsPanel:$(".unpairButtonsPanel"),paginationContainer:".device-pairing__pagination",widgetId:$("#widgetId").text(),pbContext:encodeURI($("[name='pbContext']").attr("content")),$selectEmailInstButton:$(".selectEmailInstButton"),$confirmAddEmailButton:$(".confirmAddEmailButton"),$continueInstButton:$(".continueInstButton"),isInstitutionMode:$(".dp-institution-template").length>0,clientPagination:null,init:function init(){$(".device-pairing-demo").length||o.initialization(),o.clientPagination=jQuery.extend(!0,{},UX.clientPagination),o.clientPagination.set.containerName(o.paginationContainer),o.clientPagination.set.tableRowName(o.pairingHistoryTableRow),o.clientPagination.init(),o.control(),o.additionalControl()},initialization:function initialization(){o.$pairedDevicesTable.length>0&&(o.isInstitutionMode&&$.get("/pb/widgets/ux3/DevicePairingManagementController/pairedDevicesOfUser?widgetId="+o.widgetId+"&pbContext="+o.pbContext,{serviceName:$(".serviceNameHidden").text(),userEmail:$(".userEmailHidden").text()}).done((function(e){o.on.fillPairedDevicesTable(e)})).fail((function(e,t,i){o.on.displayErrorDialog("error occure on the server : "+i)})),o.isInstitutionMode||$.get("/pb/widgets/ux3/DevicePairingController/pairedDevices?widgetId="+o.widgetId+"&pbContext="+o.pbContext,{}).done((function(e){o.on.fillPairedDevicesTable(e)})).fail((function(e,t,i){o.on.displayErrorDialog("error occure on the server : "+i)}))),o.$pairingHistoryTable.length>0&&$.get("/pb/widgets/ux3/DevicePairingManagementController/pairingHistory?widgetId="+o.widgetId+"&pbContext="+o.pbContext,{serviceName:$(".serviceNameHidden").text(),userEmail:$(".userEmailHidden").text()}).done((function(e){e.indexOf("device-pairing__row")>=0?(o.$pairingHistoryTable.find("tbody").html(e),o.$pairingHistoryTable.trigger("update"),o.clientPagination.buildPagination(),o.$pairingHistoryTable.removeClass("hidden"),o.$noPairedDevicesHistoryResult.addClass("hidden")):(o.$pairingHistoryTable.addClass("hidden"),o.$noPairedDevicesHistoryResult.removeClass("hidden"))})).fail((function(e,t,i){o.on.displayErrorDialog("error occure on the server : "+i)}))},control:function control(){n.on("change",".institutionId-radio",(function(e){o.$continueInstButton.prop("disabled",!1)})),n.on("change",".instEmailSelected-checkbox",(function(e){$("input[name=instEmailSelected]:checked").length>0?o.$selectEmailInstButton.prop("disabled",!1):o.$selectEmailInstButton.prop("disabled",!0)})),n.on("keyup",".instEmailSelected-textbox",(function(e){$(".device-pairing__add-instEmail .error").addClass("hidden"),""!==$(this).val()&&o.check.isValidEmail($(this).val())?o.$confirmAddEmailButton.prop("disabled",!1):o.$confirmAddEmailButton.prop("disabled",!0)})),n.on("focusout",".instEmailSelected-textbox",(function(e){""!==$(this).val()&&(o.check.isValidEmail($(this).val())?o.$confirmAddEmailButton.prop("disabled",!1):$(".device-pairing__add-instEmail .error").removeClass("hidden"))})),n.on("change","input[name=deviceId]",(function(e){$("input[name=deviceId]:checked").length>0?o.$instAdminUnpairSelectedBtn.prop("disabled",!1):o.$instAdminUnpairSelectedBtn.prop("disabled",!0)})),n.on("click","#instAdminUnpairSelected",(function(e){e.preventDefault(),o.selectedDevicesArray=[],o.$deviceSelectedList.empty(),o.$pairedDevicesTable.find("input[name='deviceId']:checked").each((function(){o.selectedDevicesArray.push($(this).attr("id")),o.$deviceSelectedList.append("<li>"+$(this).val()+"</li>")}))})),n.on("click","#instAdminUnpairAll",(function(e){e.preventDefault(),o.selectedDevicesArray=[],o.$deviceSelectedList.empty(),o.$pairedDevicesTable.find("input[name='deviceId']").each((function(){o.selectedDevicesArray.push($(this).attr("id")),o.$deviceSelectedList.append("<li>"+$(this).val()+"</li>")}))})),n.on("click","#ConfirmUnpairDevices",(function(e){e.preventDefault(),o.isInstitutionMode&&$.get("/pb/widgets/ux3/DevicePairingManagementController/unpairSelected?widgetId="+o.widgetId+"&pbContext="+o.pbContext,{serviceName:$(".serviceNameHidden").text(),userEmail:$(".userEmailHidden").text(),devices:JSON.stringify(o.selectedDevicesArray),antiForgeryToken:$(".antiForgeryToken").text()}).done((function(e){o.on.fillPairedDevicesTable(e)})).fail((function(e,t,i){o.on.displayErrorDialog("error occure on the server : "+i)})),o.isInstitutionMode||$.get("/pb/widgets/ux3/DevicePairingController/unpairSelected?widgetId="+o.widgetId+"&pbContext="+o.pbContext,{devices:JSON.stringify(o.selectedDevicesArray)}).done((function(e){o.on.fillPairedDevicesTable(e)})).fail((function(e,t,i){o.on.displayErrorDialog("error occure on the server : "+i)})),o.selectedDevicesArray=[],o.$unpairDialogForm.modal("toggle")}))},additionalControl:function additionalControl(){},on:{fillPairedDevicesTable:function fillPairedDevicesTable(e){o.$pairedDevicesTable.find("tbody").html(e),o.$pairedDevicesTable.trigger("update"),o.$instAdminUnpairSelectedBtn.prop("disabled",!0),e.indexOf("device-pairing__row")>=0?(o.$pairedDevicesTable.removeClass("hidden"),o.$unpairButtonsPanel.removeClass("hidden"),o.$noPairedDevicesResult.addClass("hidden")):(o.$pairedDevicesTable.addClass("hidden"),o.$unpairButtonsPanel.addClass("hidden"),o.$noPairedDevicesResult.removeClass("hidden"))},displayErrorDialog:function displayErrorDialog(e){$("#devicePairingError").find(".message").html(e),$("#devicePairingError").modal("toggle")}},check:{isValidEmail:function isValidEmail(e){return!!/^\b[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b$/i.test(e)}}},UX.devicePairing=o},855:function(e,t,i){"use strict";i.r(t);i(818),i(819);UX,UX.dropblockUl.on.dropdownBuild=function(e){UX.dropBlock&&UX.dropBlock.init(),e.wrap('<div class="profile-menu--dropBlock" data-db-parent-of="dbTab-profile-menu"></div>');var t=e.closest(".profile-menu--dropBlock"),i=UX.dropblockUl.get.activeTab(e);t.prepend('<a href="#" data-db-target-for="dbTab-profile-menu"><span>'+i.text()+'</span><i class="icon-arrow_down pull-right" aria-hidden="true"></i></a>'),e.attr("data-db-target-of","dbTab-profile-menu")};i(820),i(821);var n,o=i(13),r=i.n(o);i(822);function ownKeys(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(i),!0).forEach((function(t){r()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}(n=(UX||{}).alerts).selectors=n.selectors||{},n.elements=n.elements||{},n.texts=n.texts||{},n.productSelectors=_objectSpread(_objectSpread({},n.selectors),{},{backUriCitationInput:'#citation input[name="backURI"]',alertTypeCitationInput:'#citation input[name="alertType"]',citaionSortby:"citationsortby",citationInputs:'#citation .table__mark input[type="checkbox"]',activeTabElement:".tab__pane.active"}),n.productElements=_objectSpread(_objectSpread({},n.elements),{},{backUriCitationInput:document.querySelector(n.productSelectors.backUriCitationInput),citaionSortby:document.getElementById(n.productSelectors.citaionSortby),alertTypeCitationInput:document.querySelector(n.productSelectors.alertTypeCitationInput),citationInputs:document.querySelectorAll(n.productSelectors.citationInputs)}),n.productTexts=_objectSpread(_objectSpread({},n.texts),{},{backUriCitationInputValue:"/action/showPreferences?menuTab=Alerts&activeTab=citation",alertTypeCitationInputValue:"citation",formAction:"/action/showAlertSettings"}),n.additionalController=function(){var e,t=this;this.modifyInputValue(this.productElements.backUriCitationInput,this.productTexts.backUriCitationInputValue),this.modifyInputValue(this.productElements.alertTypeCitationInput,this.productTexts.alertTypeCitationInputValue),null===(e=this.productElements.citaionSortby)||void 0===e||e.addEventListener("change",this.on.sorting_change.bind(this)),this.productElements.citationInputs.forEach((function(e){null==e||e.addEventListener("change",t.toggleInputValues)}))},n.toggleInputValues=function(e){var t=e.target;t.checked?(t.nextElementSibling.setAttribute("disabled","true"),t.closest("tr").classList.add("selected")):(t.nextElementSibling.removeAttribute("disabled"),t.closest("tr").classList.remove("selected"))},n.modifyInputValue=function(e,t){null==e||e.setAttribute("value",t)},n.createInput=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hidden",n=document.createElement("input");return n.setAttribute("type",i),n.setAttribute("name",e),n.setAttribute("value",t),n},n.on.sorting_change=function(e){e.stopPropagation();var t=this.productElements.citaionSortby,i=t.closest(this.productSelectors.activeTabElement),n="#".concat(i.getAttribute("id")),o=t.value;sessionStorage.setItem("activeTab",n);var r=document.createElement("form");r.setAttribute("action",this.productTexts.formAction),r.append(this.createInput("type","citation"),this.createInput("menuTab","Alerts"),this.createInput("sortBy",o),this.createInput("activeTab","citation")),document.body.appendChild(r),r.submit()};var a=i(16),s=i.n(a);i(823);UX.devicePairing.additionalControl=function(){var e=document.querySelectorAll('.device-pairing__row input[type="checkbox"]');(null!==e||e.length>0)&&s()(e).forEach((function(e){e.onclick=function(e){var t=e.currentTarget.closest("tr");null!==t&&t.classList.toggle("device-pairing__row--bold")}}))};var l=i(9);!function(e){var t={widget:null,holdingsForm:null,sendToRadioGroup:null,emailsListInput:null,submitButton:null,emailsListRadio:null,errorHolder:null,selectors:{WIDGET_CONTAINER:".holdings",FORM:"#formHoldings",EMAILS_LIST:"#emailsList",EMAILS_LIST_RADIO:"#list",SEND_TO:".holdings__send-to",SUBMIT_BTN:".btn-submit",ERROR_HOLDER:".message.error"},classList:{DISPLAY_NONE:"d-none",DISPLAY_FLEX:"d-flex",IS_VALID:"is-valid",IS_INVALID:"is-invalid"},init:function init(){this.widget=document.querySelector(this.selectors.WIDGET_CONTAINER),this.widget&&(this.holdingsForm=this.widget.querySelector(this.selectors.FORM),this.sendToRadioGroup=this.holdingsForm.querySelector(this.selectors.SEND_TO),this.emailsListRadio=this.sendToRadioGroup.querySelector(this.selectors.EMAILS_LIST_RADIO),this.emailsListInput=this.holdingsForm.querySelector(this.selectors.EMAILS_LIST),this.submitButton=this.holdingsForm.querySelector(this.selectors.SUBMIT_BTN),this.errorHolder=this.holdingsForm.querySelector(this.selectors.ERROR_HOLDER),this.controller())},controller:function controller(){this.holdingsForm.addEventListener("submit",this.onSubmitHandler.bind(this)),this.sendToRadioGroup.addEventListener("change",this.onSendToChangeHandler.bind(this))},onSendToChangeHandler:function onSendToChangeHandler(e){var t=this.emailsListRadio.checked;this.emailsListInput.disabled=!t,this.emailsListInput.setAttribute("required",t),this.emailsListInput.setAttribute("aria-disabled",!t),this.emailsListInput.value="",this.setValid()},onSubmitHandler:function onSubmitHandler(e){return!(!this.emailsListInput.disabled&&!this.validateEmails())||(e.preventDefault(),!1)},setValid:function setValid(){this.emailsListInput.classList.remove(this.classList.IS_INVALID),this.emailsListInput.setAttribute("aria-invalid","false"),this.errorHolder.classList.add(this.classList.DISPLAY_NONE),this.submitButton.disabled=!1},validateEmails:function validateEmails(){this.setValid();var e=!0;return this.emailsListInput.value.split(",").forEach((function(t){if(!(e=Object(l.d)(t.trim())))return!1})),!!e||(this.emailsListInput.classList.add(this.classList.IS_INVALID),this.emailsListInput.setAttribute("aria-invalid","true"),this.emailsListInput.classList.add("is-invalid"),this.errorHolder.classList.remove(this.classList.DISPLAY_NONE),this.emailsListInput.focus(),!1)}};e.holdings=t}(UX);t.default=function main(e){var t=Array.prototype.slice.call(document.getElementsByClassName("institutionList")),i=Array.prototype.slice.call(document.getElementsByClassName("profile-menu")),n=Array.prototype.slice.call(document.getElementsByClassName("trusted-proxy-form")),o=document.getElementById("institutionUsageReport"),r=Array.prototype.slice.call(document.querySelectorAll(".alerts, #institutionUsageReport")),a=Array.prototype.slice.call(document.getElementsByClassName("device-pairing__devices")),s=Array.prototype.slice.call(document.querySelectorAll("body"));try{t.length&&e.profileMain.init(t)}catch(e){console.error(e)}try{i.length&&e.dropblockUl.init(i)}catch(e){console.error(e)}try{n.length&&e.trustedPoxy.init(n)}catch(e){console.error(e)}try{o&&e.reports.init(o)}catch(e){console.error(e)}try{r.length&&e.alerts.init(r)}catch(e){console.error(e)}try{a.length&&e.devicePairing.init(a)}catch(e){console.error(e)}try{s.length&&e.holdings.init(s)}catch(e){console.error(e)}}}}]);
//# sourceMappingURL=profile-f4ce9c6d5a69b8306c56.js.map