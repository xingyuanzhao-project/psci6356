(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{177:function(y,m,b){var _,I,C,N=b(1);C=function t(){"use strict";function e(y,m){var b=Object.keys(y);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(y);m&&(_=_.filter((function(m){return Object.getOwnPropertyDescriptor(y,m).enumerable}))),b.push.apply(b,_)}return b}function t(y){for(var m=1;m<arguments.length;m++){var b=null!=arguments[m]?arguments[m]:{};m%2?e(Object(b),!0).forEach((function(m){r(y,m,b[m])})):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(b)):e(Object(b)).forEach((function(m){Object.defineProperty(y,m,Object.getOwnPropertyDescriptor(b,m))}))}return y}function n(y){return(n="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(y){return N(y)}:function(y){return y&&"function"==typeof Symbol&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":N(y)})(y)}function r(y,m,b){return m in y?Object.defineProperty(y,m,{value:b,enumerable:!0,configurable:!0,writable:!0}):y[m]=b,y}function i(y){return function(y){if(Array.isArray(y))return s(y)}(y)||function(y){if("undefined"!=typeof Symbol&&null!=y[Symbol.iterator]||null!=y["@@iterator"])return Array.from(y)}(y)||o(y)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(y,m){if(y){if("string"==typeof y)return s(y,m);var b=Object.prototype.toString.call(y).slice(8,-1);return"Object"===b&&y.constructor&&(b=y.constructor.name),"Map"===b||"Set"===b?Array.from(y):"Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b)?s(y,m):void 0}}function s(y,m){(null==m||m>y.length)&&(m=y.length);for(var b=0,_=new Array(m);b<m;b++)_[b]=y[b];return _}var y=function u(y){return"string"==typeof y?document.querySelector(y):y()},m=function a(m,b){var _="string"==typeof m?document.createElement(m):m;for(var I in b){var C=b[I];if("inside"===I)C.append(_);else if("dest"===I)y(C[0]).insertAdjacentElement(C[1],_);else if("around"===I){var N=C;N.parentNode.insertBefore(_,N),_.append(N),null!=N.getAttribute("autofocus")&&N.focus()}else I in _?_[I]=C:_.setAttribute(I,C)}return _},b=function c(y,m){return y=String(y).toLowerCase(),m?y.normalize("NFD").replace(/[\u0300-\u036f]/g,"").normalize("NFC"):y},_=function l(y,b){return m("mark",t({innerHTML:y},"string"==typeof b&&{class:b})).outerHTML},I=function f(y,m){m.input.dispatchEvent(new CustomEvent(y,{bubbles:!0,detail:m.feedback,cancelable:!0}))},C=function p(y,m,I){var C=I||{},N=C.mode,P=C.diacritics,M=C.highlight,D=b(m,P);if(m=String(m),y=b(y,P),"loose"===N){var Y=(y=y.replace(/ /g,"")).length,q=0,p=Array.from(m).map((function(m,b){return q<Y&&D[b]===y[q]&&(m=M?_(m,M):m,q++),m})).join("");if(q===Y)return p}else{var R=D.indexOf(y);if(~R)return y=m.substring(R,R+y.length),M?m.replace(y,_(y,M)):m}},P=function d(y,m){return new Promise((function(b,_){var C;return(C=y.data).cache&&C.store?b():new Promise((function(y,b){return"function"==typeof C.src?C.src(m).then(y,b):y(C.src)})).then((function(m){try{return y.feedback=C.store=m,I("response",y),b()}catch(y){return _(y)}}),_)}))},M=function h(y,m){var b=m.data,_=m.searchEngine,N=[];b.store.forEach((function(I,P){var M=function a(b){var P=b?I[b]:I,M="function"==typeof _?_(y,P):C(y,P,{mode:_,diacritics:m.diacritics,highlight:m.resultItem.highlight});if(M){var a={match:M,value:I};b&&(a.key=b),N.push(a)}};if(b.keys){var D,Y=function(y,m){var b="undefined"!=typeof Symbol&&y[Symbol.iterator]||y["@@iterator"];if(!b){if(Array.isArray(y)||(b=o(y))){b&&(y=b);var _=0,I=function i(){};return{s:I,n:function n(){return _>=y.length?{done:!0}:{done:!1,value:y[_++]}},e:function e(y){throw y},f:I}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var C,N=!0,P=!1;return{s:function s(){b=b.call(y)},n:function n(){var y=b.next();return N=y.done,y},e:function e(y){P=!0,C=y},f:function f(){try{N||null==b.return||b.return()}finally{if(P)throw C}}}}(b.keys);try{for(Y.s();!(D=Y.n()).done;)M(D.value)}catch(y){Y.e(y)}finally{Y.f()}}else M()})),b.filter&&(N=b.filter(N));var P=N.slice(0,m.resultsList.maxResults);m.feedback={query:y,matches:N,results:P},I("results",m)},D="aria-expanded",Y="aria-activedescendant",q="aria-selected",R=function v(y,m){y.feedback.selection=t({index:m},y.feedback.results[m])},B=function g(y){y.isOpen||((y.wrapper||y.input).setAttribute(D,!0),y.list.removeAttribute("hidden"),y.isOpen=!0,I("open",y))},H=function w(y){y.isOpen&&((y.wrapper||y.input).setAttribute(D,!1),y.input.setAttribute(Y,""),y.list.setAttribute("hidden",""),y.isOpen=!1,I("close",y))},W=function O(y,m){var b=m.resultItem,_=m.list.getElementsByTagName(b.tag),C=!!b.selected&&b.selected.split(" ");if(m.isOpen&&_.length){var N,P,M=m.cursor;y>=_.length&&(y=0),y<0&&(y=_.length-1),m.cursor=y,M>-1&&(_[M].removeAttribute(q),C&&(P=_[M].classList).remove.apply(P,i(C))),_[y].setAttribute(q,!0),C&&(N=_[y].classList).add.apply(N,i(C)),m.input.setAttribute(Y,_[m.cursor].id),m.list.scrollTop=_[y].offsetTop-m.list.clientHeight+_[y].clientHeight+5,m.feedback.cursor=m.cursor,R(m,y),I("navigate",m)}},z=function A(y){W(y.cursor+1,y)},U=function k(y){W(y.cursor-1,y)},$=function L(y,m,b){(b=b>=0?b:y.cursor)<0||(y.feedback.event=m,R(y,b),I("selection",y),H(y))};function j(y,b){var _=this;return new Promise((function(I,C){var N,D;return N=b||((D=y.input)instanceof HTMLInputElement||D instanceof HTMLTextAreaElement?D.value:D.innerHTML),function(y,m,b){return m?m(y):y.length>=b}(N=y.query?y.query(N):N,y.trigger,y.threshold)?P(y,N).then((function(b){try{return y.feedback instanceof Error?I():(M(N,y),y.resultsList&&function(y){var b=y.resultsList,_=y.list,I=y.resultItem,C=y.feedback,N=C.matches,P=C.results;if(y.cursor=-1,_.innerHTML="",N.length||b.noResults){var M=new DocumentFragment;P.forEach((function(y,b){var _=m(I.tag,t({id:"".concat(I.id,"_").concat(b),role:"option",innerHTML:y.match,inside:M},I.class&&{class:I.class}));I.element&&I.element(_,y)})),_.append(M),b.element&&b.element(_,C),B(y)}else H(y)}(y),c.call(_))}catch(y){return C(y)}}),C):(H(y),c.call(_));function c(){return I()}}))}var J=function S(y,m){for(var b in y)for(var _ in y[b])m(b,_)};function E(y){var b=this;return new Promise((function(_,C){var N,M,D;if(N=y.placeHolder,D={role:"combobox","aria-owns":(M=y.resultsList).id,"aria-haspopup":!0,"aria-expanded":!1},m(y.input,t(t({"aria-controls":M.id,"aria-autocomplete":"both"},N&&{placeholder:N}),!y.wrapper&&t({},D))),y.wrapper&&(y.wrapper=m("div",t({around:y.input,class:y.name+"_wrapper"},D))),M&&(y.list=m(M.tag,t({dest:[M.destination,M.position],id:M.id,role:"listbox",hidden:"hidden"},M.class&&{class:M.class}))),function T(y){var m,b,_,I=y.events,C=(m=function n(){return j(y)},b=y.debounce,function(){clearTimeout(_),_=setTimeout((function(){return m()}),b)}),N=y.events=t({input:t({},I&&I.input)},y.resultsList&&{list:I?t({},I.list):{}}),P={input:{input:function input(){C()},keydown:function keydown(m){!function(y,m){switch(y.keyCode){case 40:case 38:y.preventDefault(),40===y.keyCode?z(m):U(m);break;case 13:m.submit||y.preventDefault(),m.cursor>=0&&$(m,y);break;case 9:m.resultsList.tabSelect&&m.cursor>=0&&$(m,y);break;case 27:m.input.value="",H(m)}}(m,y)},blur:function blur(){H(y)}},list:{mousedown:function mousedown(y){y.preventDefault()},click:function click(m){!function(y,m){var b=m.resultItem.tag.toUpperCase(),_=Array.from(m.list.querySelectorAll(b)),I=y.target.closest(b);I&&I.nodeName===b&&$(m,y,_.indexOf(I))}(m,y)}}};J(P,(function(m,b){(y.resultsList||"input"===b)&&(N[m][b]||(N[m][b]=P[m][b]))})),J(N,(function(m,b){y[m].addEventListener(b,N[m][b])}))}(y),y.data.cache)return P(y).then((function(y){try{return c.call(b)}catch(y){return C(y)}}),C);function c(){return I("init",y),_()}return c.call(b)}))}function x(y){var m=y.prototype;m.init=function(){E(this)},m.start=function(y){j(this,y)},m.unInit=function(){if(this.wrapper){var y=this.wrapper.parentNode;y.insertBefore(this.input,this.wrapper),y.removeChild(this.wrapper)}var m;J((m=this).events,(function(y,b){m[y].removeEventListener(b,m.events[y][b])}))},m.open=function(){B(this)},m.close=function(){H(this)},m.goTo=function(y){W(y,this)},m.next=function(){z(this)},m.previous=function(){U(this)},m.select=function(y){$(this,null,y)},m.search=function(y,m,b){return C(y,m,b)}}return function e(m){this.options=m,this.id=e.instances=(e.instances||0)+1,this.name="autoComplete",this.wrapper=1,this.threshold=1,this.debounce=0,this.resultsList={position:"afterend",tag:"ul",maxResults:5},this.resultItem={tag:"li"},function(m){var b=m.name,_=m.options,I=m.resultsList,C=m.resultItem;for(var N in _)if("object"===n(_[N]))for(var P in m[N]||(m[N]={}),_[N])m[N][P]=_[N][P];else m[N]=_[N];m.selector=m.selector||"#"+b,I.destination=I.destination||m.selector,I.id=I.id||b+"_list_"+m.id,C.id=C.id||b+"_result",m.input=y(m.selector)}(this),x.call(this,e),E(this)}},"object"==N(m)&&void 0!==y?y.exports=C():void 0===(I="function"==typeof(_=C)?_.call(m,b,m,y):_)||(y.exports=I)},469:function(y,m,b){"use strict";b.r(m),b.d(m,"default",(function(){return U}));var _=b(3),I=b.n(_),C=b(4),N=b.n(C),P=b(5),M=b.n(P),D=b(2),Y=b.n(D),q=b(8),R=b.n(q),B=b(6),H=b.n(B),W=b(177),z=b.n(W);function _callSuper(y,m,b){return m=Y()(m),M()(y,function _isNativeReflectConstruct(){try{var y=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(y){}return function _isNativeReflectConstruct(){return!!y}()}()?Reflect.construct(m,b||[],Y()(y).constructor):m.apply(y,b))}var U=function(y){function SageSocietyLogin(){var y;return I()(this,SageSocietyLogin),(y=_callSuper(this,SageSocietyLogin)).societyWidget=document.querySelector(y._selectors.SOCIETY_WIDGET),y.societyWidget&&y.initialize(),y}return H()(SageSocietyLogin,y),N()(SageSocietyLogin,[{key:"selectors",get:function get(){return{SOCIETY_WIDGET:".society-login",SOCIETY_ELEMENT:'[name="societyCode"]',TPS_CONTAINER:".society-login__tps",YM_CONTAINER:".society-login__ym",SOCIETY_DESCRIPTION_EL:".society-login__description",TPS_BUTTON:".btn",SSO_SOCIETY_EL:'[name="ssoSociety"]',AUTOCOMPLETE_ELEMENT:".js--autocomplete-element",FORM:".sage-sso-login form"}}},{key:"classList",get:function get(){return{DISPLAY_NONE:"d-none",DISPLAY_FLEX:"d-flex"}}},{key:"initialize",value:function initialize(){!function _superPropGet(y,m,b,_){var I=R()(Y()(1&_?y.prototype:y),m,b);return 2&_&&"function"==typeof I?function(y){return I.apply(b,y)}:I}(SageSocietyLogin,"initialize",this,3)([]),this.data={},this.autocompleteEl=this.societyWidget.querySelector(this._selectors.AUTOCOMPLETE_ELEMENT),this.societyInput=this.societyWidget.querySelector(this._selectors.SOCIETY_ELEMENT),this.tpsContainer=this.societyWidget.querySelector(this._selectors.TPS_CONTAINER),this.ymContainer=this.societyWidget.querySelector(this._selectors.YM_CONTAINER),this.form=$(".sage-sso-login form"),this.societyInput&&this.control()}},{key:"control",value:function control(){this.autocompleteEl&&(this.addListener(),this.autocomplete())}},{key:"addListener",value:function addListener(){var y=this;this.form.on("submit",(function(m){m.preventDefault();var b=$(y).serialize();$.ajax({url:$(y).attr("action"),type:$(y).attr("method"),data:b,success:function success(y){if(y.includes("success")){var m=document.querySelector(".alert--success");m.style.display="flex",setTimeout((function(){m.style.display="none"}),3e3)}},error:function error(y,m,b){$(".useAJAX_SSO_error").removeClass("d-none").find("#invalid-login").text("There was an error with the login request.")}})}))}},{key:"onSocietySelection",value:function onSocietySelection(y){switch(this.data=JSON.parse(y),this.resetBlocks(),this.data.society_type){case"YM":this.setYMBlock();break;case"TPS":this.setTPSBlock()}}},{key:"resetBlocks",value:function resetBlocks(){this.tpsContainer.classList.add(this._classList.DISPLAY_NONE),this.ymContainer.classList.add(this._classList.DISPLAY_NONE)}},{key:"setTPSBlock",value:function setTPSBlock(){this.tpsContainer.querySelector(this._selectors.SOCIETY_DESCRIPTION_EL).innerHTML=this.data.society_description;var y=this.tpsContainer.querySelector(this._selectors.TPS_BUTTON);y.setAttribute("href",this.data.society_link),y.querySelector("span").innerText=this.data.society_button_text,this.tpsContainer.classList.remove(this._classList.DISPLAY_NONE)}},{key:"setYMBlock",value:function setYMBlock(){this.ymContainer.querySelector(this._selectors.SOCIETY_DESCRIPTION_EL+" span").innerHTML=this.data.society_name||"",this.ymContainer.querySelector(this._selectors.SSO_SOCIETY_EL).value=this.data.society_code,this.ymContainer.classList.remove(this._classList.DISPLAY_NONE)}},{key:"autocomplete",value:function autocomplete(){var y=JSON.parse(this.autocompleteEl.dataset.data),m=this,b=new z.a({selector:this._selectors.AUTOCOMPLETE_ELEMENT,data:{src:y,keys:["society_name"]},resultsList:{tag:"div",class:"autocomplete dropdown-menu show",maxResults:250,noResults:!0},resultItem:{tag:"div",class:"dropdown-item",highlight:"single_highlight_class"},wrapper:!1,threshold:0,debounce:300,highlight:!0,events:{input:{focus:function focus(){var y=b.input.value||"";b.start(y)},selection:function selection(y){var _=y.detail,I=JSON.stringify(_.selection.value);b.input.value=_.selection.value.society_name,b.input.dataset.value=I,m.onSocietySelection(I)}}}})}}])}(b(7).a)}}]);
//# sourceMappingURL=SageSocietyLogin-939673d355a6bd107fac.js.map