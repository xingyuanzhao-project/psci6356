(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{806:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return l}));var n=i(3),s=i.n(n),o=i(4),r=i.n(o),l=function(){return r()((function CitedBy(){s()(this,CitedBy),this.selectors={citedArticles:".citing-articles",list:".citing-articles__list",contentList:".cited-by__content",metricsToolbar:'[data-id="article-toolbar-metrics"]',seeMoreWrapper:".seeMoreWrapper",loadingContentSpinner:".loading-wrapper",viewMore:".citing-articles__view-more"},this.content={loadingSpinner:'<div class="loading-wrapper" tabindex="0"><div class="loader"></div><span role="alert" aria-label="loading citations"><span aria-hidden="true">loading citations</span></span><div class="loading"></div></div>',citedByListContent:'<ul class="rlist cited-by__list"></ul><div class="cited-by__alert"></div>',citationsLoadedAlert:'<div class="sr-only" tabindex="-1" role="alert" aria-label="Citations loaded"></div>'},this.elements={citedByEl:null,list:null,viewMoreBtn:null,seeMoreWrapper:null,contentList:null,metricsToolbar:null},this.isTriggered=!1,this.setElements(),this.init()}),[{key:"setElements",value:function setElements(){this.elements.citedByEl=document.querySelector(this.selectors.citedArticles),this.elements.list=document.querySelector(this.selectors.list),this.elements.viewMoreBtn=document.querySelector(this.selectors.viewMore),this.elements.seeMoreWrapper=document.querySelector(this.selectors.seeMoreWrapper),this.elements.contentList=document.querySelector(this.selectors.contentList),this.elements.metricsToolbar=document.querySelector(this.selectors.metricsToolbar)}},{key:"init",value:function init(){this.control()}},{key:"control",value:function control(){var e;null===(e=this.elements.viewMoreBtn)||void 0===e||e.addEventListener("click",this.viewMoreCitation.bind(this)),this.citationFirstCall()}},{key:"citationFirstCall",value:function citationFirstCall(){var e=this;this.elements.contentList&&!this.elements.list&&""!==this.elements.contentList.dataset.source&&this.elements.metricsToolbar&&["click","keydown"].forEach((function(t){e.elements.metricsToolbar.addEventListener(t,e.buildInitContent.bind(e))}))}},{key:"buildInitContent",value:function buildInitContent(e){var t=this;if((13===(e.keyCode?e.keyCode:e.which)||"click"===e.type)&&!this.isTriggered){this.elements.contentList.insertAdjacentHTML("beforeend",this.content.citedByListContent),this.elements.list=null===this.elements.list&&this.elements.contentList.querySelector(".citing-articles__list");var i="".concat(this.elements.contentList.dataset.source,"&ajaxRequest=true");this.elements.list.innerHTML=this.elements.content.loadingSpinner;var n=this.elements.list.querySelector(this.selectors.loadingContentSpinner);setTimeout((function(){return n.focus()}),350),fetch(i).then((function(e){return e.json()})).then((function(e){t.buildLoadedContent(e,n,t.elements.list),t.init()})),this.isTriggered=!0}}},{key:"viewMoreCitation",value:function viewMoreCitation(e){var t=this;if(e.target.classList.contains("citing-articles__view-more")){var i="".concat(e.target.dataset.source,"&ajaxRequest=true");this.elements.list.removeChild(document.querySelector(this.selectors.seeMoreWrapper)),this.elements.list.insertAdjacentHTML("afterend",this.content.loadingSpinner);var n=this.elements.contentList.querySelector(this.selectors.loadingContentSpinner);fetch(i).then((function(e){return e.json()})).then((function(e){t.buildLoadedContent(e,n,t.elements.list)}))}}},{key:"buildLoadedContent",value:function buildLoadedContent(e,t,i){var n=this;if(e.item.citations.length&&e.item.citations.forEach((function(t,n){var s=t.title,o="system"===t.source?"/doi/".concat(t.doi,"?").concat(e.icid+(n+1)):t.urls.source,r='\n    <li class="citing-articles__article">\n        <div class="citing-articles__article__title">'.concat(s,'</div>\n        <div class="citing-articles__article__links">\n            <a class="btn btn-outline-primary" target="_blank" rel="noopener" href="').concat(o,'">').concat("Go to citation","</a>\n            ").concat(t.urls.crossref?'<a target="_blank" rel="noopener" href="'.concat(t.urls.crossref,'">').concat("Crossref","</a>"):"","\n            ").concat(t.urls["google-scholar"]?'<a target="_blank" rel="noopener" href="'.concat(t.urls["google-scholar"],'">').concat("Google Scholar","</a>"):"","\n            ").concat(t.urls.pubmed?'<a target="_blank" rel="noopener" href="'.concat(t.urls.pubmed,'">').concat("Pub Med","</a>"):"","\n        </div>\n    </li>");i.insertAdjacentHTML("beforeend",r)})),e.seeMoreLink){var s='<li class="citing-articles__article seeMoreWrapper ">\n    <a href="javascript:void(0)" data-source="'.concat(e.seeMoreLink,'" class="btn btn-secondary citing-articles__view-more">View More</a>\n</li>');i.insertAdjacentHTML("beforeend",s)}setTimeout((function(){var e;n.additionalContentBuild(t,i),null===(e=document.querySelector(".citing-articles__view-more"))||void 0===e||e.addEventListener("click",n.viewMoreCitation.bind(n))}),500)}},{key:"additionalContentBuild",value:function additionalContentBuild(e,t){var i=t.nextElementSibling.children[0];i.tabIndex=0,i.focus(),i.addEventListener("blur",this.removeTabIndexAttribute),this.elements.contentList.removeChild(e)}},{key:"removeTabIndexAttribute",value:function removeTabIndexAttribute(e){e.target.removeAttribute("tabindex")}}])}()}}]);
//# sourceMappingURL=citedBy-92d946a82ea7cc660048.js.map